<!doctype html>
<html lang="en-US">
<head>
    <link rel="stylesheet" href="../common/doxygen.css">
	<link rel="stylesheet" href="../common/style.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
	<script src="dynsections.js"></script>
	<script src="../common/sidebar.js"></script>
    <title>HOOPS Exchange Documentation</title>
    <link rel="shortcut icon" href="../common/favicon.ico">
</head>
<body>
<div class="header-background">
	<div class="header-margins">
        <div style="float: left;"><img src="../product/images/logo.png"></div>
        <div style="margin-left: 520px; margin-right: 20px;">
            <div class="search" id="Search"> 
                <form method="get" action="http://developer.techsoft3d.com/cgi/swish-hoops-exchange.cgi" enctype="application/x-www-form-urlencoded" class="form">
                    <label style='color: gray;'>Search: </label>
                    <input maxlength="200" value="" size="20" name="query" type="text">
                </form>
            </div>
        </div>
    </div>
</div>
<div class="cdiv">
<div class="content-body">
<div class="content-internalframe"><!-- Generated by Doxygen 1.8.7 -->
</div><!-- top -->
<div class="contents">
<div class="textblock"><p> 
</div></div>
</p>
<h2>2.2 PRC</h2>
<p>The complexity of PRC structures generally reflects the complexity of the original model file. Among other things, geometry is often instanced, materials are often referenced multiple times, and whole subassemblies can be nested hundreds of levels deep. As a result, parsing and interpreting the PRC structures is non-trivial. This section explains how to traverse the assembly tree and calculate the attributes of each entity.</p>
<p>After successfully loading a model file, you will have access to the model file pointer. This object grants access to the root product occurrences of the assembly tree. Be aware that throughout the tree, the way in which sibling nodes are ordered in their respective arrays is significant, as the attributes of the first node may affect sibling nodes.</p>
<p>PRC consists of four main types of entities which form a hierarchy.</p>
<center> <div class="image">
<img src="images/prc-structure.png" />
</div>
 </center><p>The list below describes the hierarchy starting at the root:</p>
<ul class="square">
<li>
<b>Model file</b> is the root PRC entity, represented by <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__structure__types.html#gac7a33edf07bb7f390e7b05f1c71827ac">A3DAsmModelFile</a>. There is only one model file per assembly tree. The model file structure contains references to the product occurrences as well as global information such as the unit scale and the modelling system used to create the file. </li>
<li>
<b>Product occurrence</b> is a logical group of geometric information. These nodes are the building blocks of the PRC assembly tree and represent the root data structure for an assembly and all the information contained within. A product occurrence node may contain many child product occurrences, or it could represent just a single part. It can also be used to instance other geometry by referencing other product occurrences. The class name is <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__structure__types.html#ga1c8f3d19250cb0e87b1ca2576198393a">A3DAsmProductOccurrence</a>. </li>
<li>
<b>Part definitions</b> contain metadata about the geometry such as as annotations, views, the bounding box, as well as a reference to the part's geometric representation. The class name is <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__structure__types.html#gaf3e6be2ea18b59e0c45f969886222cf0">A3DAsmPartDefinition</a>. A product occurrence may only contain a single part definition. </li>
<li>
<b>Representation items</b> encapsulate information about how to draw the geometry. This includes the model transform, tessellation data, and B-rep information, if available. Particularly complex parts in the model may consist of multiple representation items. The class name is <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__repitems__types.html#ga388f0de3dcd14843e7f0c4a501c5ade7">A3DRiRepresentationItem</a>. </li>
</ul>
<p>Each entity exists as a single node in the assembly tree. In HOOPS Exchange, the nodes themselves contain no data - the developer must explicitly call for the actual data container to be filled. That process is described <a href="api_conventions.html#getting-node-data">here</a>.</p>
<p>Please note that in this section and throughout this manual, we will attempt to explain how to perform common tasks using HOOPS Exchange. The manual does not go into fine detail regarding the PRC file format. If you are planning a deep integration with HOOPS Exchange, you should familiarize yourself with the PRC standard. That standard can be found in the <a href="http://docs.techsoft3d.com/exchange/latest/SC2N570-PRC-WD.pdf" target="_blank">PRC Format Specification</a> document.</p>
<p><a class="anchor" id="units"></a></p><h3>Units</h3>
<p>Most model files provide the measurement units for the geometry contained within. The unit type may be global - meaning it is applied to all geometry - or it may be provided for each assembly or even for each individual part.</p>
<p>You can determine if the model you're loading uses a global scale by examining the <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_asm_model_file_data.html#a4c67e843436a316a769163c916d72908">A3DAsmModelFileData::m_bUnitFromCAD</a> field. If the model uses a global scale, then this field will be <span class="code">true</span>, and you can find the actual units in the <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_asm_model_file_data.html#a5d5d96e6ea122443f2383c546051faa4">A3DAsmModelFileData::m_dUnit</a> field. The units are specified in multiples of millimeters. Accordingly, a value of '1' indicates millimeters, '10' indicates centimeters, and so on.</p>
<p>It is not possible to have more than one valid unit. When assemblies of multiple parts specify different units, HOOPS Exchange will scale all units into a single unit type for simplicity.</p>
<h4>How to interpret non-global unit scale</h4>
<p>If the <span class="code">m_bUnitFromCad</span> field is <span class="code">false</span>, then you must parse the assembly tree to find the unit scale. In this case, the unit value can be found on the first product occurrence encountered that has the flag <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_asm_product_occurrence_data.html#afec8e1375f2a26c7101103057a886d76">A3DAsmProductOccurrenceData::m_bUnitFromCAD</a> set to <span class="code">true</span>. To better understand, consider the diagram below:</p>
<center> <div class="image">
<img src="images/unit_diagram.png" />
</div>
 </center><p>Although "Product Occurrence 4" is located higher in the assembly tree, and <span class="code">m_bUnitFromCAD</span> is <span class="code">true</span>, "Product Occurrence 3" will be parsed first - therefore, the unit scale that applies to the model is the one on "Product Occurrence 3".</p>
<p>In some cases, you can override any unit setting from the model by setting the read parameter <span class="code">A3DRWParamsLoadData::A3DRWParamsGeneralData::m_eDefaultUnit</span> accordingly. By setting the value to <span class="code">kA3DUnitUnknown</span>, you will guarantee the native unit of the CAD file is used. See this field's reference manual entry for details.</p>
<p><a class="anchor" id="brep-units"></a></p><h4>Dealing with B-rep units</h4>
<p>When parsing a representation item with B-rep, you have to find the units in another way. The scale you need access to is stored in each <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_context_data.html">A3DTopoContextData</a> structure. The following code snippet demonstrates how you would get the unit scale in this case, in this case starting from a <a class="elRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_ri_curve_data.html">A3DRiCurveData</a> structure: </p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_ri_curve_data.html">A3DRiCurveData</a> sDataRiCurve;</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./_a3_d_s_d_k_initialize_functions_8h.html#a874707247fe3898ce09144884ea08eb3">A3D_INITIALIZE_DATA</a>(sDataRiCurve);</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__ricurve.html#ga9a831221b130be6b2f0a57fc64c90a03">A3DRiCurveGet</a>(pRiCrv, &amp;sDataRiCurve);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_single_wire_body_data.html">A3DTopoSingleWireBodyData</a> sDataTopoSingleWireBody;</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./_a3_d_s_d_k_initialize_functions_8h.html#a874707247fe3898ce09144884ea08eb3">A3D_INITIALIZE_DATA</a>(sDataTopoSingleWireBody);</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__singlewirebody.html#ga793764b8567c2244ebbaadd28df51e54">A3DTopoSingleWireBodyGet</a>(sDataRiCurve.<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_ri_curve_data.html#a827e32611e4c90764c94dc5c8524024d">m_pBody</a>, &amp;sDataTopoSingleWireBody);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_body_data.html">A3DTopoBodyData</a> sBodyData;</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./_a3_d_s_d_k_initialize_functions_8h.html#a874707247fe3898ce09144884ea08eb3">A3D_INITIALIZE_DATA</a>(<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_body_data.html">A3DTopoBodyData</a>, sBodyData);</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__topobody.html#ga0d6894870839dcd00650c827ee94b8df">A3DTopoBodyGet</a>(sDataRiCurve.<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_ri_curve_data.html#a827e32611e4c90764c94dc5c8524024d">m_pBody</a>, &amp;sBodyData);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_context_data.html">A3DTopoContextData</a> sContextData;</div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./_a3_d_s_d_k_initialize_functions_8h.html#a874707247fe3898ce09144884ea08eb3">A3D_INITIALIZE_DATA</a>(<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_context_data.html">A3DTopoContextData</a>, sContextData);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./group__a3d__topocontext.html#ga37c1d58b824fe433fdcd34bed6bb6776">A3DTopoContextGet</a>(sBodyData.<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_body_data.html#a25a0522b5effdf91781fcf2e4b40d5c1">m_pContext</a>, &amp;sContextData);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> scale = 1.0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (sContextData.<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_context_data.html#aa3f1c12b12a7912bfcb6bd829c6164d1">m_bHaveScale</a>)</div>
<div class="line">    scale = sContextData.<a class="codeRef" doxygen="D:/Jenkins/workspace/MakeDoc_Hoops3DX/final-package/documentation.exchange/build/api_ref/exchange.tag:./" href="./struct_a3_d_topo_context_data.html#abac5960bce2b6c021e116e366d07d4e0">m_dScale</a>;</div>
</div><!-- fragment --><h4>Additional notes regarding scale</h4>
<p>In addition to the notes above regarding scale, you also need to consider any scale present on an entity's individual <a href="transformations.html">transformation</a>.</p>
</div></div><!-- contents -->

    <div id="accordion" class="sidebar">
		<p class="accordion-toggle">Overview</p>
			<div class="accordion-content overview">
				<ul>
					<li><a href="technical_overview.html">Technical&nbsp;Overview</a></li>
					<li><a href="getting_started.html">Getting&nbsp;Started</a></li>
					<li><a href="distributing_your_application.html">Distributing Platforms</a></li>
					<li><a href="supported_platforms.html">Supported Platforms</a></li>
					<li><a href="overview.html">File Formats</a></li>
					<li><a href="release_notes.html">Release&nbsp;Notes</a></li>
					<li><a href="samples.html">Sample Code</a></li>
					<li><a href="acknowledgments.html">Acknowledgments</a></li>
					<li><a href="http://developer.techsoft3d.com/developer-support/" target="_blank">Contact Support</a></li>
				</ul>
			</div>
		<p class="accordion-toggle">Programming Guide</p>
			<div class="accordion-content default">
				<div class="indent">
					<p class="accordion-toggle">1 Introduction</p>
					<ul>
						<li><a href="introduction.html">1.0 Introduction</a></li>
						<li><a href="initialize_exchange.html">1.1 Initializing HOOPS Exchange</a></li>
						<li><a href="api_conventions.html">1.2 API Conventions</a></li>
					</ul>
					<p class="accordion-toggle">2 Basic Operations</p>
					<ul>
						<li><a href="load_model.html">2.1 Simple Model Load and Export</a></li>
						<li><a href="prc.html">2.2 PRC Basics</a></li>
						<li><a href="building_prc.html">2.3 Building PRC</a></li>
					</ul>
					<p class="accordion-toggle">3 Entities</p>
					<ul>
						<li><a href="product_occurrence.html">3.0 Product Occurrences</a></li>
						<li><a href="product_occurrence.html#partDefinitions">3.1 Part Definitions</a></li>
						<li><a href="product_occurrence.html#prototypes">3.2 Prototypes</a></li>
						<li><a href="product_occurrence.html#externals">3.3 Externals</a></li>
						<li><a href="product_occurrence.html#displayParameters">3.4 Display Parameters</a></li>
						<li><a href="product_occurrence.html#filtersLayers">3.5 Filters and Layers</a></li>
						<li><a href="product_occurrence.html#configurations">3.6 Configurations</a></li>
						<li><a href="persistent_ids.html">3.7 Persistent IDs</a></li>
					</ul>
                    <p class="accordion-toggle">4 Geometry</p>
					<ul>
						<li><a href="reading_geometry.html">4.0 Reading Model Geometry</a></li>
						<li><a href="getting_tessellation.html">4.1 Getting Tessellation</a></li>
						<li><a href="getting_brep.html">4.2 Getting B-rep Data</a></li>
						<li><a href="tessellation_example.html">4.3 Tessellation Example</a></li>
						<li><a href="approx_as_analytic.html">4.4 Display Parameters</a></li>
					</ul>
                    <p class="accordion-toggle">5 Entity Attributes</p>
					<ul>
						<li><a href="colors_materials.html">5.1 Colors and Materials</a></li>
						<li><a href="managing_attribute_inheritance.html">5.2 Managing Attribute Inheritance</a></li>
						<li><a href="transformations.html">5.3 Transformations</a></li>
					</ul>
                    <p><a href="markup.html">6 Markup and Views</a></p>
                    <p class="accordion-toggle">7 Advanced Functions</p>
					<ul>
						<li><a href="advanced.html#computingLengths">7.1 Computing Lengths</a></li>
						<li><a href="advanced.html#physicalProperties">7.2 Getting Physical Properties</a></li>
						<li><a href="advanced.html#modelCompare">7.3 Model Compare</a></li>
						<li><a href="advanced.html#modelSewing">7.4 Model Sewing</a></li>
						<li><a href="advanced.html#computingSections">7.5 Computing Sections</a></li>
						<li><a href="advanced.html#comparingPointClouds">7.6 Model to Point Cloud Comparison</a></li>
						<li><a href="advanced.html#shattered">7.7 Shattered Loading</a></li>
					</ul>
                    <p><a href="hoops_exchange_for_parasolid_developers.html">8 HOOPS Exchange for Parasolid Developers</a></p>
				</div>
			</div>
		<p class="accordion-toggle">API Reference</p>
			<div class="accordion-content api_ref">
				<ul>
					<li><a href="classes.html">Data Structures</a></li>
					<li><a href="f_index.html">Functions</a></li>
					<li><a href="modules.html">Modules</a></li>
					<li><a href="files.html">Files</a></li>
					<li><a href="functions.html">Fields</a></li>
					<li><a href="globals.html">Globals</a></li>
				</ul>
			</div>
    </div>
<div class="footer">
	HOOPS Exchange 2016 SP1 U4&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.techsoft3d.com">www.techsoft3d.com</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://developer.techsoft3d.com">developer.techsoft3d.com</a>
</div>
</body>
</html>